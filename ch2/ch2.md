## 图形渲染
#### 顶点和索引
和表面的复杂度以及点的数量无关，WebGL有一套标准方式来处理几何图形。这里使用两种数据类型来表示任何三维对象的几何图形：顶点和索引
#### 顶点(Vertex)
顶点是定义三维对象角的点。每个顶点都是由对应于x、y、z坐标的三个浮点数表示。与opengl不同，WebGL不提供api方法来向渲染管道传递独立的顶点，因此我们需要将所有的顶点写入到js数组，用它构造一个WebGL顶点缓冲区
#### 索引(Indices)
索引是在一个给定的三维场景中的顶点数字标签。索引允许我们告诉WebGL如何连接顶点来生成一个曲面。和顶点一样，索引储存在js数组中，然后使用WebGL索引缓冲区将他们传递给WebGL的渲染管道
#### WebGL的渲染管道简图
![image](https://cdn.jsdelivr.net/gh/yexian-01/images/company/202110261104522.png)
#### 顶点缓冲区对象(Vertex Buffer Objects[VBOs])
VBOs包含WebGL描述即将呈现的几何数据。除了顶点数据，还有一些数据元素，如顶点法线、颜色和纹理坐标等，可以被构建在VBOs中。
#### 顶点着色器(Vertex shader)
每个顶点都会调用顶点着色器。这个着色器操作着每个顶点数据，如顶点坐标、法线、颜色和纹理等。此数据由顶点着色器内的属性表示。
#### 片元着色器(Fragment shader)
每一组三个顶点定义了一个三角形，该三角形表面上的每个元素都需要指定一种颜色。否则，我们的表面将是透明的。  
每个表面元素都被称为一个片元。由于我们处理的是将显示在屏幕上的表面，这些元素通常被称为像素。  
片元着色器的主要目标是计算单个像素的颜色。如下图所示：
![image](https://cdn.jsdelivr.net/gh/yexian-01/images/company/202110261409882.png)
#### 帧缓冲(Framebuffer)
它是一个二维缓冲区，其中包含已由片元着色器处理的片元。一旦所有的片元处理完成，一个二维的图像就生成并展示在屏幕上了。帧缓冲是渲染管道的最后一站。
#### Attributes, uniforms, and varyings
**Attributes**  
该输入变量在顶点着色器中使用，如顶点坐标，顶点颜色等。由于在每个顶点上都调用了顶点着色器，所以每次调用时，该属性都会变化  
**uniforms**  
该输入变量同时用于顶点着色器和片元着色器。和Attributes不一样，该变量在渲染周期中是恒定的。如灯光的位置  
**Varyings**  
该变量用于将数据从顶点着色器传递给片元着色器
#### 在WebGL中渲染几何
1. 使用js数组定义几何对象
2. 创建WebGL各自的缓冲区
3. 我们将把一个顶点着色器属性指向我们在上一步中创建的存储顶点坐标的vbo
4. 最后使用ibo来完成渲染  
![image](https://cdn.jsdelivr.net/gh/yexian-01/images/company/202110261448103.png)
#### 将属性和VBO们关联起来
一旦VBOs创建完，我们就会将这些缓冲和顶点着色器属性进行关联。每个顶点着色器属性将会根据已经建立的对应关系，引用一个并且仅引用一个缓冲区，如下图所示：
![image](https://cdn.jsdelivr.net/gh/yexian-01/images/personal/202201310043319.png)